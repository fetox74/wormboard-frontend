<div class="header-wrapper">
  <div class="header">
    <h2>WormBoard</h2>v0.2
    <div class="year" (click)="onYearMenu($event)">
      {{selectedYear}}
      <div class="yearmenu" [@menuState]="menuState">
        <div class="yearmenuitem" *ngFor="let year of years" (click)="onSelectYear($event, [year])">{{year}}</div>
      </div>
    </div>
    <div id="all" class="month" (click)="onSelect('ALL')" [ngClass]="{'selected' : 'ALL' === selectedMonth}">ALL</div>
    <div id="jan" class="month" (click)="onSelect('Jan')" [ngClass]="{'selected' : 'Jan' === selectedMonth, 'inactive' : !isMonthAvailable('Jan')}">Jan</div>
    <div id="feb" class="month" (click)="onSelect('Feb')" [ngClass]="{'selected' : 'Feb' === selectedMonth, 'inactive' : !isMonthAvailable('Feb')}">Feb</div>
    <div id="mar" class="month" (click)="onSelect('Mar')" [ngClass]="{'selected' : 'Mar' === selectedMonth, 'inactive' : !isMonthAvailable('Mar')}">Mar</div>
    <div id="apr" class="month" (click)="onSelect('Apr')" [ngClass]="{'selected' : 'Apr' === selectedMonth, 'inactive' : !isMonthAvailable('Apr')}">Apr</div>
    <div id="may" class="month" (click)="onSelect('May')" [ngClass]="{'selected' : 'May' === selectedMonth, 'inactive' : !isMonthAvailable('May')}">May</div>
    <div id="jun" class="month" (click)="onSelect('Jun')" [ngClass]="{'selected' : 'Jun' === selectedMonth, 'inactive' : !isMonthAvailable('Jun')}">Jun</div>
    <div id="jul" class="month" (click)="onSelect('Jul')" [ngClass]="{'selected' : 'Jul' === selectedMonth, 'inactive' : !isMonthAvailable('Jul')}">Jul</div>
    <div id="aug" class="month" (click)="onSelect('Aug')" [ngClass]="{'selected' : 'Aug' === selectedMonth, 'inactive' : !isMonthAvailable('Aug')}">Aug</div>
    <div id="sep" class="month" (click)="onSelect('Sep')" [ngClass]="{'selected' : 'Sep' === selectedMonth, 'inactive' : !isMonthAvailable('Sep')}">Sep</div>
    <div id="oct" class="month" (click)="onSelect('Oct')" [ngClass]="{'selected' : 'Oct' === selectedMonth, 'inactive' : !isMonthAvailable('Oct')}">Oct</div>
    <div id="nov" class="month" (click)="onSelect('Nov')" [ngClass]="{'selected' : 'Nov' === selectedMonth, 'inactive' : !isMonthAvailable('Nov')}">Nov</div>
    <div id="dec" class="month" (click)="onSelect('Dec')" [ngClass]="{'selected' : 'Dec' === selectedMonth, 'inactive' : !isMonthAvailable('Dec')}">Dec</div>
    <div class="serverinfo">{{status}}</div>
  </div>
</div>

<p-dataTable [value]="aggregates" resizableColumns="true" [rows]="100" [paginator]="true" [pageLinks]="3" [rowsPerPageOptions]="[10,25,50,100]"
             scrollable="true" scrollHeight="calc(100vh - 168px)" sortField="netisk" sortOrder="-1">

  <p-column header="Rank" [style]="{'width':'4%', 'text-align':'right'}">
    <ng-template let-col let-ri="rowIndex" pTemplate="body">
      <span>{{ri + 1}}</span>
    </ng-template>
  </p-column>

  <p-column field="corporation" header="Corporation" [sortable]="true" [style]="{'width':'18%'}"></p-column>

  <p-column field="kills" header="Kills" [sortable]="true" [style]="{'width':'4%', 'text-align':'right'}"></p-column>

  <p-column field="isk" header="Isk" [sortable]="true" [style]="{'text-align':'right'}">
    <ng-template let-col let-aggregate="rowData" pTemplate="body">
      <span>{{aggregate[col.field] | number:'1.2-2' | isk:condenseIsk}}</span>
    </ng-template>
  </p-column>

  <p-column field="netisk" header="NetIsk" [sortable]="true" [style]="{'text-align':'right'}">
    <ng-template let-col let-aggregate="rowData" pTemplate="body">
      <span *ngIf="aggregate[col.field] >= 0">{{aggregate[col.field] | number:'1.2-2' | isk:condenseIsk}}</span>
      <span class="negative-number" *ngIf="aggregate[col.field] < 0">{{aggregate[col.field] | number:'1.2-2'| isk:condenseIsk}}</span>
    </ng-template>
  </p-column>

  <p-column field="numactive" header="NumActive" [sortable]="true" [style]="{'width':'6%', 'text-align':'right'}"></p-column>

  <p-column field="avgperkill" header="AvgOnKill" [sortable]="true" [style]="{'width':'6%', 'text-align':'right'}">
    <ng-template let-col let-aggregate="rowData" pTemplate="body">
      <span>{{aggregate[col.field] | number:'1.2-2' | isk:condenseIsk}}</span>
    </ng-template>
  </p-column>

  <p-column field="iskperactive" header="IskPerActive" [sortable]="true" [style]="{'text-align':'right'}">
    <ng-template let-col let-aggregate="rowData" pTemplate="body">
      <span>{{aggregate[col.field] | number:'1.2-2' | isk:condenseIsk}}</span>
    </ng-template>
  </p-column>

  <p-column field="netiskperactive" header="NetIskPerActive" [sortable]="true" [style]="{'text-align':'right'}">
    <ng-template let-col let-aggregate="rowData" pTemplate="body">
      <span *ngIf="aggregate[col.field] >= 0">{{aggregate[col.field] | number:'1.2-2' | isk:condenseIsk}}</span>
      <span class="negative-number" *ngIf="aggregate[col.field] < 0">{{aggregate[col.field] | number:'1.2-2' | isk:condenseIsk}}</span>
    </ng-template>
  </p-column>

  <p-column field="iskperavgonkill" header="IskPerAvgOnKill" [sortable]="true" [style]="{'text-align':'right'}">
    <ng-template let-col let-aggregate="rowData" pTemplate="body">
      <span>{{aggregate[col.field] | number:'1.2-2' | isk:condenseIsk}}</span>
    </ng-template>
  </p-column>

  <p-column field="netiskperavgonkill" header="NetIskPerAvgOnKill" [sortable]="true" [style]="{'text-align':'right'}">
    <ng-template let-col let-aggregate="rowData" pTemplate="body">
      <span *ngIf="aggregate[col.field] >= 0">{{aggregate[col.field] | number:'1.2-2' | isk:condenseIsk}}</span>
      <span class="negative-number" *ngIf="aggregate[col.field] < 0">{{aggregate[col.field] | number:'1.2-2' | isk:condenseIsk}}</span>
    </ng-template>
  </p-column>
</p-dataTable>

<div class="footer">
  <switch id="isk-switch" [(status)]="condenseIsk" onText="on" offText="off" size="mini" (statusChange)="onToggleISKPipe($event)"></switch>
  <span id="isk-switch-label">Condense ISK</span>
  <span id="about" (click)="displayAbout=true">About</span> / <span id="legal" (click)="displayLegal=true">Legal</span> / Disclaimer
</div>

<p-dialog header="About WormBoard" [(visible)]="displayAbout" modal="modal" width="700" responsive="true">
  <h3>Why</h3>
  <p>WormBoard is an Eve Online wormhole corp comparison list heavily inspired by the work of Noobman (CEO of Hard Knocks) and ExookiZ (CEO of Scary
    Wormhole People).
    <br><br>The main motivation is to make smaller wormhole groups more comparable to larger ones, thus completely ignoring alliances and shared killmails.</p>
  <br>
  <h3>How</h3>
  <p>It fetches all kills per day from zKillboard.com and filters for the ones happening in w-space, then adding them to daily aggregates based on the final hit
    corporation.<br><br>
    That way kills are only counted for the final hit corp and only the attackers of that corp are taken into account, this is intended.
    It does not remove infrastructure kills, because corporations that have specialized in that field need to be accommodated too,
    as well as lucky offline POS finds.</p>
  <br>
  <h3>Who</h3>
  <ul>
    <li>Ingame: fetox74</li>
    <li>IRL: <a href="mailto:odittrich@gmx.de">odittrich@gmx.de</a></li>
  </ul>
  <p-footer>
    <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
      <button type="button" pButton icon="fa-check" (click)="displayAbout=false" label="OK"></button>
    </div>
  </p-footer>
</p-dialog>

<p-dialog header="Legal" [(visible)]="displayLegal" modal="modal" width="640" responsive="true">
  <h3>CCP</h3>
  <p>EVE Online and the EVE logo are the registered trademarks of CCP hf. All rights are reserved worldwide.
    All other trademarks are the property of their respective owners. EVE Online, the EVE logo,
    EVE and all associated logos and designs are the intellectual property of CCP hf.
    All artwork, screenshots, characters, vehicles, storylines, world facts or other recognizable features of the intellectual property relating
    to these trademarks are likewise the intellectual property of CCP hf.
    CCP is in no way responsible for the content on or functioning of this website, nor can it be liable for any damage arising from the use of this
    website.</p>
  <br>
  <h3>3rd Party</h3>
  <p>WormBoard makes heavy use of the zKillboard API, thanks to Squizz Caphinator for making it available!</p>
  <h4>Un-ordered list of Software used</h4>
  <ul>
    <li>Angular 2</li>
    <li>PrimeNG</li>
    <li>Spring Boot</li>
    <li>Google Guava</li>
    <li>PostgreSQL</li>
    <li>Apache Tomcat / HTTP Server</li>
    <li>Python</li>
  </ul>
  <br>
  <h3>License</h3>
  <p>WormBoard will be released under the AGPLv3 license once it reaches release state. Full license text will be available in the GitHub repository.</p>
  <p-footer>
    <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
      <button type="button" pButton icon="fa-check" (click)="displayLegal=false" label="OK"></button>
    </div>
  </p-footer>
</p-dialog>

